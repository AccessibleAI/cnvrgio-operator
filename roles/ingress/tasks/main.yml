- name: Deploy OpenShift Route
  include_role:
    name: common
    tasks_from: install
  vars:
    template_path: "{{ item }}"
    state: "present"
  with_items:
    - templates/ocp-route/app.yml
    - templates/ocp-route/ea.yml
    - templates/ocp-route/es.yml
    - templates/ocp-route/grafana.yml
    - templates/ocp-route/kibana.yml
    - templates/ocp-route/minio.yml
    - templates/ocp-route/prom.yml
    - templates/ocp-route/cnvrg_router.yml
  when:
  - ingress_type == "openshift"

- name: Deploy VirtualServices
  include_role:
    name: common
    tasks_from: install
  vars:
    template_path: "{{ item }}"
    state: "present"
  with_fileglob:
    - templates/istio-vs/*
  when: ingress_type == "istio"

- name: Deploy K8S Ingress rules
  include_role:
    name: common
    tasks_from: install
  vars:
    template_path: "{{ item }}"
    state: "present"
  with_fileglob:
    - templates/k8s-ingress/*
  when: ingress_type == "k8singress"